<!DOCTYPE html>
<html lang="zh-Hans">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    
    
    
    
    


    <!-- meta -->


<title>Flutter上手指南（环境搭建） | { }</title>


    <meta name="keywords" content="Flutter, 技术/iOS/大前端">




    <!-- OpenGraph -->
 
    <meta name="description" content="“Write once, run anywhere”，在移动互联网时代是一个难以抗拒的诱惑。">
<meta name="keywords" content="Flutter">
<meta property="og:type" content="article">
<meta property="og:title" content="Flutter上手指南（环境搭建）">
<meta property="og:url" content="http://blog.knpc21.com/ios/flutter-dev-start/index.html">
<meta property="og:site_name" content="{ }">
<meta property="og:description" content="“Write once, run anywhere”，在移动互联网时代是一个难以抗拒的诱惑。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://blog.knpc21.com/ios/flutter-dev-start/flutter-arch.png">
<meta property="og:image" content="http://blog.knpc21.com/ios/flutter-dev-start/flutter-render.png">
<meta property="og:updated_time" content="2019-01-15T05:53:20.000Z">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Flutter上手指南（环境搭建）">
<meta name="twitter:description" content="“Write once, run anywhere”，在移动互联网时代是一个难以抗拒的诱惑。">
<meta name="twitter:image" content="http://blog.knpc21.com/ios/flutter-dev-start/flutter-arch.png">


    <link rel="stylesheet" href="/css/style/main.css"> 

    
    
        <link rel="stylesheet" id="hl-default-theme" href="/css/highlight/default.css" media="none" onload="this.media='all'">
        
    

    
    

    

     

    <!-- custom head -->

</head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">余的技术博客</span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/" class="navbar-menu button">首页</a>
                
                    <a href="/archives/" class="navbar-menu button">归档</a>
                
                    <a href="/tags/" class="navbar-menu button">标签</a>
                
                    <a href="/about" class="navbar-menu button">关于</a>
                
            </div>
        
        
        
    <a href="/search/" id="btn-search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="24" height="24" fill="currentColor" stroke="currentColor" stroke-width="32"><path d="M192 448c0-141.152 114.848-256 256-256s256 114.848 256 256-114.848 256-256 256-256-114.848-256-256z m710.624 409.376l-206.88-206.88A318.784 318.784 0 0 0 768 448c0-176.736-143.264-320-320-320S128 271.264 128 448s143.264 320 320 320a318.784 318.784 0 0 0 202.496-72.256l206.88 206.88 45.248-45.248z"></path></svg>
    </a>


        
        

        
            <a class="dropdown-icon button" id="btn-dropdown" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round"><path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path></svg></a>
            <div class="dropdown-menus" id="dropdown-menus">
                
                    <a href="/" class="dropdown-menu button">首页</a>
                
                    <a href="/archives/" class="dropdown-menu button">归档</a>
                
                    <a href="/tags/" class="dropdown-menu button">标签</a>
                
                    <a href="/about" class="dropdown-menu button">关于</a>
                
            </div>
        
    </div>
</header>


            <main class="main">
    

<div class="post-title">
    <h1 class="post-title__text">
        Flutter上手指南（环境搭建）
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2019/01/" class="post-meta__date button">2019-01-15</a>
        
 
        
    
    


 

 
    </div>
</div>



<article class="post content-card">
    <div class="post__header"></div>
    <div class="post__content">
        <p>“Write once, run anywhere”，在移动互联网时代是一个难以抗拒的诱惑。</p>
<a id="more"></a>
<p>自2018年2月27日发布Beta版以来，Flutter在国内移动端的「讨论」越来越活跃。再加之咸鱼团队的押注加持，越来越多的团队开始打起了Flutter的主意。</p>
<p>是的，”Write once, run anywhere”，在移动互联网时代是一个难以抗拒的诱饵。接入端的分化，对服务商是一个成本问题，产品亦在朝着淡化接入端的差异性的方向发展。H5、React Native、Weex、Lua、Xamarin都不失为一种值得考虑的方案。而小程序这两年的强势突进，各个互联网Giant不得不警惕和防守。而对开发人员来说，又是另一抉问题的抉择了。</p>
<p>Flutter不是第一个跨平台开发的框架，当然也不会是最后一个。与上述提到的方案不同的是，Flutter不是对原生平台底层框架的桥接，而是另起炉灶基于Skia引擎进行渲染。但毕竟UI只是业务开发的一部分，具体还看性能及框架提供的能力。</p>
<p>本文先介绍上手指南之环境搭建（Mac平台），再来简单看看Flutter的基础原理知识。</p>
<!-- more -->
<h4 id="环境要求"><a href="#环境要求" class="headerlink" title="# 环境要求"></a># 环境要求</h4><ul>
<li>Mac OS 64位 </li>
<li>磁盘空间700MB（不包括IDE </li>
<li>命令行工具：bash、curl、git、mkdir、rm、unzip、which </li>
<li>Xcode 9.0+(请确保xcode-select指向正确的版本)</li>
</ul>
<h4 id="下载SDK"><a href="#下载SDK" class="headerlink" title="# 下载SDK"></a># 下载SDK</h4><p>下载地址可在<a href="https://flutter.dev/docs/get-started/install/macos" target="_blank" rel="noopener">官网</a>获取，本次使用地址：<a href="https://storage.googleapis.com/flutter_infra/releases/stable/macos/flutter_macos_v1.7.8+hotfix.3-stable.zip" target="_blank" rel="noopener">v1.7.8</a>（约600M） </p>
<p>下载完成后解压缩SDK到工作目录。可考虑预加载依赖项、执行命令flutter precache 。</p>
<h4 id="环境配置"><a href="#环境配置" class="headerlink" title="# 环境配置"></a># 环境配置</h4><p>终端执行flutter doctor检查环境，检查是否需要安装其他依赖项来完成。</p>
<p>可能遇到报错： </p>
<blockquote>
<p>GIH-D-11754% flutter doctor        </p>
<p>Doctor summary (to see all details, run flutter doctor -v): </p>
<p>[✓] Flutter (Channel stable, v1.7.8+hotfix.3, on Mac OS X 10.13.6 17G65, locale </p>
<p>​    zh-Hans-CN) </p>
<p>[✗] Android toolchain - develop for Android devices </p>
<p>​    ✗ Unable to locate Android SDK. </p>
<p>​     …</p>
<p>​      If the Android SDK has been installed to a custom location, set </p>
<p>​      ANDROID_HOME to that location. </p>
<p>​      You may also want to add it to your PATH environment variable. </p>
<p>⣟ideviceinfo returned an error: </p>
<p>ERROR: Could not connect to lockdownd, error code -17 </p>
</blockquote>
<p>修改bash配置，将flutter的可执行文件路径配置到PATH中： </p>
<blockquote>
<p>export PATH=/Users/cc/Kernel/0xFlutter/flutter/bin:$PATH </p>
<p>export PUB_HOSTED_URL=<a href="https://pub.flutter-io.cn" target="_blank" rel="noopener">https://pub.flutter-io.cn</a> </p>
<p>export FLUTTER_STORAGE_BASE_URL=<a href="https://storage.flutter-io.cn" target="_blank" rel="noopener">https://storage.flutter-io.cn</a> </p>
</blockquote>
<p>后面两个是避免网络环境问题，可使用国内站点。</p>
<p>若已安装Android Studio，配置：</p>
<blockquote>
<p>export ANDROID_HOME=/Users/cc/DevEnv/Android/sdk </p>
<p>#Android 模拟器路径 </p>
<p>export PATH=${PATH}:${ANDROID_HOME}/emulator </p>
<p>#Android tools 路径 </p>
<p>export PATH=${PATH}:${ANDROID_HOME}/tools </p>
<p>#Android 平台工具路径 </p>
<p>export PATH=${PATH}:${ANDROID_HOME}/platform-tools </p>
<p>#Android NDK路径 </p>
<p>export ANDROID_NDK_HOME=/Users/cc/DevEnv/Android/ndk/android-ndk-r10e </p>
</blockquote>
<p>若暂时不使用Android开发，可暂不安装Android Studio（而且这货也挺大的） 。</p>
<h4 id="创建Demo"><a href="#创建Demo" class="headerlink" title="# 创建Demo"></a># 创建Demo</h4><p>终端运行：flutter create</p>
<p>可能会遇到失败的情况： </p>
<blockquote>
<p>…</p>
<p>All done! </p>
<p>ideviceinfo returned an error: </p>
<p>ERROR: Could not connect to lockdownd, error code -17 </p>
</blockquote>
<p>继续。</p>
<p>安装将flutter安装到设备的工具：（官方） </p>
<blockquote>
<p>brew install –HEAD libimobiledevice </p>
<p>brew install ideviceinstaller ios-deploy cocoapods</p>
<p>#注：若已安装旧版本可能有不兼容情况，删除重装</p>
</blockquote>
<p>安装libimobiledevice失败，需要安装usbmuxd：（若原已安装，可以先brew unlink usbmuxd ） </p>
<blockquote>
<p>brew install –HEAD usbmuxd</p>
<p>重新安装工具：</p>
<p>brew install –HEAD usbmuxd </p>
<p>brew link usbmuxd </p>
<p>brew install –HEAD libimobiledevice </p>
<p>brew install ideviceinstaller ios-deploy cocoapods </p>
</blockquote>
<p>此时，flutter run 是成功的了，可以跑demo。</p>
<p>（在启动模拟器后可以运行，若存在多台设备，需要-d指定；若需真机调试，需要确保设备id已加入调试设备列表） </p>
<h4 id="IDE及配置"><a href="#IDE及配置" class="headerlink" title="# IDE及配置"></a># IDE及配置</h4><p>一般建议使用VS Code，上面也有很多相关插件，比如Dart、Flutter这些是必装的。看自己喜好。</p>
<h4 id="Flutter基本知识"><a href="#Flutter基本知识" class="headerlink" title="# Flutter基本知识"></a># Flutter基本知识</h4><p>基本环境配置完，可以来了解一下Flutter基本知识了。以下是Flutter官方给出的系统架构图：</p>
<p><img src="flutter-arch.png" alt></p>
<p>可以看出Flutter框架分为三层：Framework层、Engine层和Embedder层。</p>
<p>Embedder层是平台相关的实现，主要包括事件循环、打包、线程设置、原生插件、渲染相关；</p>
<p>Engine层则是Flutter的核心，使用C++开发的，主要包括Skia渲染引擎、Dart 虚拟机、文本布局渲染等；</p>
<p>Framework层是Dart语言实现的应用层。最顶层是Material与Cupertino两种Widge，往下则是渲染、绘画、动画、手势等基础功能的封装了。</p>
<p>那Flutter是怎么渲染的呢？可以看看官方提供的流程图：</p>
<p><img src="flutter-render.png" alt></p>
<h5 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h5><p>关于后续。个人感觉按目前单凭宣称的内置Skia渲染引擎不足以撬动整块大石头。何况Dart是单线程执行模型，很多以前遇见的问题，换成Flutter依然需要解决。热加载不一定一直试一直爽。而且Flutter需要学习新的语言及框架，相对RN等等的门槛还是提高了一点。</p>
<p>建议就是，不妨跟进与关注吧。</p>

    </div>
    
    <div class="post__license">
        <p>
            <strong>Author: </strong>Jason
        </p>
        <p>
            <strong>
                Permalink: 
            </strong>
            <a href="http://blog.knpc21.com/ios/flutter-dev-start/">http://blog.knpc21.com/ios/flutter-dev-start/</a>
        </p>
        
            <strong>
                <p>文章默认使用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 协议进行许可，使用时请注意遵守协议。</p>

            </strong>
        
    </div>
 
    <div class="post-footer__meta"><p>updated at 2019-01-15</p></div> 
    <div class="post-entry__tags"><a href="/tags/Flutter/" class="post-tags__link button"># Flutter</a></div> 
</article>


    <div class="nav">
        <div class="nav__prev">
            
                <a href="/tech/docker-basic/" class="nav__link">
                    <div>
                        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M589.088 790.624L310.464 512l278.624-278.624 45.248 45.248L400.96 512l233.376 233.376z" fill="#808080"></path></svg>
                    </div>
                    <div>
                        <div class="nav__label">
                            Previous Post
                        </div>
                        <div class="nav__title">
                            Docker：基本知识
                        </div>
                    </div>
                </a>
            
        </div>
        <div class="nav__next">
            
                <a href="/undefined/mac-software-list/" class="nav__link">
                    <div>
                        <div class="nav__label">
                            Next Post
                        </div>
                        <div class="nav__title">
                            Mac常用软件推荐
                        </div>
                    </div>
                    <div>
                        <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M434.944 790.624l-45.248-45.248L623.04 512l-233.376-233.376 45.248-45.248L713.568 512z" fill="#808080"></path></svg>
                    </div>
                </a>
            
        </div>
    </div>



    <div class="post__comments content-card" id="comment">
        
    <h4>Comments</h4>
    
    
    
    
    
    
    
    
    
    
    <div class="wildfire_thread"></div>

    


    </div>



</main>

            <footer class="footer">
     
    <a href="#" class="button" id="b2t" aria-label="Back to Top" title="Back to Top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" width="32" height="32">
            <path d="M233.376 722.752L278.624 768 512 534.624 745.376 768l45.248-45.248L512 444.128zM192 352h640V288H192z" fill="currentColor"></path>
        </svg>
    </a>

    


    
     
 

 
    
    
</footer>

        </div>
         

 

 

 

 



 



 


    
 


    <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.js"></script>
    <script>
        let lazyloadT = Boolean('false'),
            auto_fancybox = Boolean('false')
        if (auto_fancybox) {
            $(".post__content").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        } else {
            $(".post__content").find("fancybox").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        }
    </script>
 

 

 

 

 


    

    
    
    

    
    
    
    
    

    
    
    
    
    

    
    
    



    </body>
</html>
